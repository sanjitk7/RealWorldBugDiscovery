diff --git a/.github/workflows/build.yml b/.github/workflows/build.yml
index ac0cfdf7c..258d2a792 100644
--- a/.github/workflows/build.yml
+++ b/.github/workflows/build.yml
@@ -97,8 +97,9 @@ jobs:
       - name: Install Requirements
         run: |
           sudo apt-get -y install zip pandoc man sed
-          python -m pip install -U pip setuptools wheel
-          python -m pip install -U Pyinstaller -r requirements.txt
+          python -m pip install -U pip setuptools wheel pip-tools
+          pip-compile -o requirements-all.txt --extra curl_cffi setup.py
+          python -m pip install -U Pyinstaller -r requirements-all.txt
           reqs=$(mktemp)
           cat > $reqs << EOF
           python=3.10.*
@@ -267,8 +268,9 @@ jobs:
       - name: Install Requirements
         run: |
           brew install coreutils
-          python3 -m pip install -U --user pip setuptools wheel
-          python3 -m pip install -U --user Pyinstaller -r requirements.txt
+          python3 -m pip install -U --user pip setuptools wheel pip-tools
+          pip-compile -o requirements-all.txt --extra curl_cffi setup.py
+          python3 -m pip install -U --user Pyinstaller -r requirements-all.txt
 
       - name: Prepare
         run: |
@@ -306,8 +308,9 @@ jobs:
           python-version: "3.8"
       - name: Install Requirements
         run: | # Custom pyinstaller built with https://github.com/yt-dlp/pyinstaller-builds
-          python -m pip install -U pip setuptools wheel py2exe
-          pip install -U "https://yt-dlp.github.io/Pyinstaller-Builds/x86_64/pyinstaller-5.8.0-py3-none-any.whl" -r requirements.txt
+          python -m pip install -U pip setuptools wheel py2exe pip-tools
+          pip-compile -o requirements-all.txt --extra curl_cffi setup.py
+          pip install -U "https://yt-dlp.github.io/Pyinstaller-Builds/x86_64/pyinstaller-5.8.0-py3-none-any.whl" -r requirements-all.txt
 
       - name: Prepare
         run: |
diff --git a/requirements.txt b/requirements.txt
index af5119fdc..a48b78d7a 100644
--- a/requirements.txt
+++ b/requirements.txt
@@ -3,5 +3,4 @@ pycryptodomex
 websockets
 brotli; platform_python_implementation=='CPython'
 brotlicffi; platform_python_implementation!='CPython'
-curl-cffi >= 0.5.9b3
 certifi
\ No newline at end of file
diff --git a/setup.py b/setup.py
index a2f9f55c3..fd2181805 100644
--- a/setup.py
+++ b/setup.py
@@ -145,6 +145,7 @@ def main():
         url='https://github.com/yt-dlp/yt-dlp',
         packages=packages(),
         install_requires=REQUIREMENTS,
+        extras_require={'curl_cffi': ['curl-cffi >= 0.5.9b3']},
         python_requires='>=3.7',
         project_urls={
             'Documentation': 'https://github.com/yt-dlp/yt-dlp#readme',
